# 3.2.2.2.1  规则标签创建

规则标签，是规则标签是从标生成方式的维度对标签进行划分的一种类型，是指通过简单规则运算而生成的标签。规则标签分为可视化和 SQL 模式两种规则标签。可视化规则标签，是直接通过拖拽的方式将某些字段拉入逻辑框中，进行基本字段的条件过滤来筛选数据；SQL 模式规则标签，是通过直接写出 SQL 语句来筛选数据。<br />下面以创建“一天多充”的规则标签为例，介绍创建规则标签的操作步骤。<br />1、数据准备<br />本节所需的数据表是“用户信息表”，所需表中的字段为“充电时间间隔”。<br />2、创建规则标签<br />步骤一：选择【标签管理】模块 →[标签维护]→ 点击要使用的主体及目录（<充电用户>→<用户类型>→<充电时间间隔>）→ 点击左上角的“创建标签”（见图 3-2-2-2-1-1）。<br />![](<../../assets/images/(79).png#height=180&width=415>)<br />图 3-2-2-2-1-1  创建标签<br />步骤二：点击“新建标签  ”后会弹出一个小框，进入[基础信息]页面，对当前标签的基础信息进行选取填写，在标签类型一栏选择模型标签（见图 3-2-2-2-1-2）。<br />![](<../../assets/images/(80).png#height=192&width=413>)<br />图 3-2-2-2-1-2  填写基础信息<br />**标签目录：**可进行展开选取；<br />**标签密级：**分为公开和私有，私有即自己可以看，公开则是公开可看；<br />**业务含义：**即是从业务人员的角度对标签取值的说明和阐述；<br />**逻辑含义：**即是从技术人员的角度对标签取值的说明和阐述；<br />**标签类型：**即该标签所属的标签类型，目前支持规则标签、组合标签、手工标签、实时标签和模型标签，五种标签类型的创建。

| 说明：<br />1、带“\*”为必填项；<br />2、点击“暂存”按钮，可对当前配置的信息进行保存； |
| ------------------------------------------------------------------------------------ |


步骤三：点击“下一步”后，进入[标签逻辑配置]页面，即是选取的标签需要实现的逻辑进行配置，分为条件过滤和  SQL  信息配置两种。<br />方法一：条件过滤信息配置，即通过可看到具体的信息进行配置。选择配置模式为“条件过滤”→ 根据拖拉左侧标签目录中所需的基表至“虚线区域汇中”，进行基本字段的条件过滤获取数据（主要分为文本和数值的筛选）→ 点击左上“预览 SQL”，可看到可视化规则下的 SQL 语句（见图 3-2-2-2-1-3）。<br /> <br />![](<../../assets/images/(81).png#height=250&width=415>)<br />图 3-2-2-2-1-3 条件过滤逻辑配置<br />点击“预览数据”，可以加载基表中符合规则的部分数据进行查看确认（见图 3-2-2-2-1-4）。<br />![](<../../assets/images/(82).png#height=240&width=415>)<br />图 3-2-2-2-1-4  数据预览<br />方法二：SQL 信息配置，即通过 SQL 语言进行信息配置。选择配置模式为“SQL”→ 点击“插入 SQL 模板”按钮 → 在输入框内根据模板输入 SQL 语句获取数据 → 点击“检查 SQL 语法”，检查语法是否有错误 → 点击“数据预览”，对数据进行预览查看 → 确认无误后点击“下一步”（见图 3-2-2-2-1-5）。<br />![](<../../assets/images/(83).png#height=249&width=415>)<br />图 3-2-2-2-1-5  SQl 逻辑配置

| 说明：点击“预览数据”或”预览  SQL”按钮，可检查查看当前的规则标签取值是否有对应的数据或语句是否正常。再次点击，即可关闭“预览数据”或”预览  SQL”页面信息。 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |


步骤四：点击“下一步”后，进入[更新配置]页面，根据需要对标签的更新时间周期等进行设置（见图 3-2-2-2-1-6）。<br />![](<../../assets/images/(84).png#height=242&width=415>)<br />图 3-2-2-2-1-6  更新配置<br />**更新周期：**分为不更新、指定时间更新、日更新、周更新、月更新、年更新和通知更新。<br />**更新时间：**注意，更新周期为不更新和通知更新的没有更新时间。<br />**更新优先级：**分为  5  个等级，数字  1-5，优先级依次为：高-低。<br />**更新设置：**即设置这个标签通过后，更新的方式。分为标签通过审批后开始配置进行更新和标签通过审批后立即进行更新。如图：<br />**更新有效期：**即此标签的更新有效期限。注意，这里的时间选取，否则后期   标签更新无法成功。<br />**更新模式：**分为全量更新和增量更新（首次全量更新）。全量就是每次都清空原来的数据，重新根据规则加载数据进去；增量就是使用增量的规则语句，每次调度覆盖计算时，清空原来的数据，按时间增量方式增加数据，但标签首次新建时，需执行全量更新。<br />步骤五：点击“下一步”后，进入“权重配置”页面，主要是该标签在【个体洞察】词云展现中大小的权重进行配置，分为基础权重和衰减系数（见图 3-2-2-2-1-7）。<br />![](<../../assets/images/(85).png#height=240&width=415>)<br />图 3-2-2-2-1-7  权重配置<br />**基础权重：**分为附加权重倍数、附加权重常数值、权重最小值设置、权重最大值设置。<br />**衰减日期：**分为无、标签更新日期、固定时间、指定日期字段，每个衰减日期对应不同的信息设置。<br />步骤六：点击“下一步”→ 进入[审批预览]页面 → 确认审批流程无误后点击“提交”（见图 3-2-2-2-1-8）。<br />审批预览主要是对配置好的标签进行提交审批，主要功能有选取标签审批人、标签当前的状态显示、审批流程预览，审批预览配置分为有审批流程和无审批流程 2 种情况。<br />![](<../../assets/images/(86).png#height=246&width=415>)<br />图 3-2-2-2-1-8  审批预览（有审批流程）<br />**有审批流程：**若如当前有审批流程设置，则可显示当前审批信息标签当前状态、审批流程预览。标签提交审批后，状态变为“审批中”，标签需要根据审批人信息进行审批（见图 3-2-2-2-1-8）。<br />![](<../../assets/images/(87).png#height=246&width=415>)<br />图 3-2-2-2-1-9  审批预览（无审批流程）<br />**无审批流程：**若当前无审批流程设置，该标签则可提交后，直接发布启用（见图 3-2-2-2-1-9）。<br />步骤七：标签创建信息配置完后，若无需审批，则标签成功，若有审核流程限制的标签，需审核后才能看到标签更新成功（见图 3-2-2-2-1-10）。<br />![](<../../assets/images/(88).png#height=139&width=415>)<br />图 3-2-2-2-1-10  新建标签成功图示<br />标签创建成功指系统存在该标签，但并未给对应标签主体打上该标签，因此，在默认情况下，标签创建成功后显示“覆盖数量”为 0，需要手动执行标签更新操作见<3.2.3.1.1  更新监控>。

| 说明：若在更新配置中选择“标签通过审批后立即进行更新”的选项，则标签创建成功后就自动执行标签更新，显示“覆盖数量”为实际拥有该标签的标签主体数量，不需手动执行标签更新操作。 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |


<a name="XrJi3"></a>